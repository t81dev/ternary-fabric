import os
import sys
from lit.formats import ShTest

config.name = "TfmbsMlir"
config.test_format = ShTest()
config.suffixes = ['.mlir']
config.test_source_root = os.path.dirname(__file__)
config.test_exec_root = os.path.join(getattr(config, 'toplevel_build_dir', os.getcwd()), 'tests', 'mlir')

python_exec = sys.executable
config.substitutions.append(('%python', python_exec))
mlir_opt_path = os.path.join(getattr(config, 'toplevel_build_dir', os.getcwd()), 'bin', 'mlir-opt')
config.substitutions.append(('%mlir-opt', mlir_opt_path))
if sys.platform.startswith('darwin'):
    plugin_name = 'libtfmbs_plugin.dylib'
elif sys.platform.startswith('win'):
    plugin_name = 'tfmbs_plugin.dll'
else:
    plugin_name = 'libtfmbs_plugin.so'
tfmbs_plugin = os.path.join(getattr(config, 'toplevel_build_dir', os.getcwd()), plugin_name)
config.substitutions.append(('%tfmbs-plugin', tfmbs_plugin))
